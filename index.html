<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <!--
  Customize this policy to fit your own app's needs. For more guidance, see:
  https://github.com/apache/cordova-plugin-whitelist/blob/master/README.md#content-security-policy
  Some notes:
  * gap: is required only on iOS (when using UIWebView) and is needed for JS->native communication
  * https://ssl.gstatic.com is required only on Android and is needed for TalkBack to function properly
  * Disables use of inline scripts in order to mitigate risk of XSS vulnerabilities. To change this:
  * Enable inline JS: add 'unsafe-inline' to default-src--
  <meta http-equiv="Content-Security-Policy" content="default-src * 'self' 'unsafe-inline' 'unsafe-eval' data: gap: content:">-->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="theme-color" content="#2196f3">
  <meta name="format-detection" content="telephone=no">
  <meta name="msapplication-tap-highlight" content="no">
  <title>Razor</title>
  <link rel="stylesheet" href="framework7/css/razor-framework7.css">
  <link rel="stylesheet" href="fonts/Material-Icons.css">
  <link rel="stylesheet" href="fonts/Montserrat.css">
  <link rel="stylesheet" href="fonts/fa/css/fontawesome-all.min.css">
  <link rel="stylesheet" href="css/icons.css">
  <link rel="stylesheet" href="css/app.css">
  <!-- Mapbox -->
  <script src='https://api.mapbox.com/mapbox-gl-js/v0.46.0/mapbox-gl.js'></script>
  <link rel="stylesheet" href='https://api.mapbox.com/mapbox-gl-js/v0.46.0/mapbox-gl.css' />
</head>
<body>
  <div id="app" class="page color-theme-black theme-dark">
    <div class="statusbar"></div>

    <div id="view-index" class="view view-main tab tab-active">

      <div class="page" data-name="preloader" style="background-color:#000000;">


        <div id="preloader" style="display:none;background-color:#000000;background-image:url(img/step1.gif);background-size:170%;background-position:center;background-repeat:no-repeat;height:100%">
        </div>

        <div id="preloader0" style="display:none;background-color:#000010;background-image:url(img/loader3.gif);background-size:80%;background-position:center;background-repeat:no-repeat;height:100%">

          <div class="page-content login-screen-content">
            <div id="logo" style="background-image:url(img/nickford.png);background-size:43%;background-position:center;background-repeat:no-repeat;height:100%">
            </div>
            <div class="txt" style="display:block;font-weight:600;bottom:10%">
              n i c k f o r d . c o m . b r
            </div>
          </div>
        </div>

        <div id="preloader1" style="display:none;background-color:#000000;background-image:url(img/step2.gif);background-size:150%;background-position:center;background-repeat:no-repeat;height:100%">

          <div class="page-content login-screen-content">
            <div id="logo" style="background-image:url(img/razor-shield3.png);background-size:50%;background-position:center;background-repeat:no-repeat;height:100%">
            </div>
            <div id="txt0" class="txt">
              Estabelecendo conexão segura...
            </div>
            <div id="txt1" class="txt">
              Detectando geolocation...
            </div>
          </div>
        </div>

      </div>
    </div>

  </div>

  <script>
  var isApp = document.URL.indexOf('http://') === -1 && document.URL.indexOf('https://') === -1;
  </script>

  <!-- Cordova -->
  <script src="cordova.js"></script>

  <!-- Framework7 library -->
  <script src="framework7/js/framework7.min.js"></script>

  <!-- jQ -->
  <script src="js/jquery-3.2.1.min.js"></script>

  <!-- Vendor -->
  <script src="js/jquery.mask.js"></script>

  <!-- App -->
  <script src="js/funx.js"></script>
  <script src="js/routes.js"></script>
  <script src="js/app.js"></script>
  <script src="js/start.js"></script>

  <!-- Pages -->
  <script src="pages/home.js"></script>
  <script src="pages/login.js"></script>
  <script src="pages/register.js"></script>
  <script src="pages/sync.js"></script>
  <script src="pages/auto.js"></script>
  <script src="pages/wait.js"></script>

  <!-- General -->
  <script src="index.js"></script>

  <script>
  //sessionStorage.clear();

  // DEV
  if (!isApp) {
    start();
  }

  // INICIALIZAÇÃO
  if (typeof sessionStorage.auto_id === "undefined") {
    phonegap.initialize();
    $("#preloader0").show();
  }
  // APP EM USO
  else {
    $("#preloader").show();
    setTimeout(function() {
      app.router.navigate("/home/");
    }, 1000);
  }

  // VERIFICAR CONEXÃO
  function conex() {
    if (sessionStorage.online == "false") { $("#offline").show(); }
    else { $("#offline").hide(); }
    alert(sessionStorage.online);
    setTimeout(function() {
      conex();
    },5000);
  }
  conex();

  // ANIMAÇÕES
  setTimeout(function() {
    $("#preloader0").fadeOut("slow", function() {
      $("#preloader1").fadeIn("slow", function() {
        setTimeout(function() {
          $("#preloader1").fadeOut("slow", function() {
            if (localStorage.cli_id > 0) {
              app.router.navigate("/home/");
            }
            else {
              app.router.navigate("/login/");
            }
          });
        },1000);
      });
    });
  },2000);
</script>

</body>
</html>
